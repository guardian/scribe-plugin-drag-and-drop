(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.scribePluginContentCleaner=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";module.exports=function(config){var INDICATOR_CLASS="drag-and-drop";var STYLE_CLASS=config.STYLE_CLASS||"scribe-plugin-drag-and-drop-default-style";var EVENT_NAME="scribe:url-dropped";var INSERT_POSITIONS=["PRE","POST"];var filter=Array.prototype.filter;var forEach=Array.prototype.forEach;function removePreAndPost(bindableElements){var els=document.getElementsByClassName(INDICATOR_CLASS);forEach.call(els,function(el){el.parentElement.removeChild(el)});bindableElements.forEach(function(el){el.dataset.pre=false;el.dataset.post=false})}function insertP(el,position,dropId){var parent=el.parentElement;var p=document.createElement("p");p.classList.add(INDICATOR_CLASS);p.classList.add(dropId);p.classList.add(STYLE_CLASS);if(position==="PRE"&&el.dataset&&el.dataset.pre!=="true"){parent.insertBefore(p,el);el.dataset.pre=true;return el.dataset.pre}if(position==="POST"&&el.dataset&&el.dataset.post!=="true"){parent.insertBefore(p,el.nextSibling);el.dataset.post=true;return el.dataset.post}return false}function addWrappingPs(el,dropid){INSERT_POSITIONS.forEach(function(pos){return insertP(el,pos,dropid)})}function dropOccurred(event,bindableElements,dropid){var el=event.target;var parent=el.parentElement;el.classList.remove(INDICATOR_CLASS);el.classList.remove(STYLE_CLASS);el.classList.remove(dropid);window.setTimeout(function(){return removePreAndPost(bindableElements)},100);window.setTimeout(function(){return removePreAndPost(bindableElements)},500);var droppedUrl=event.dataTransfer.getData("URL");var customEvent=new CustomEvent(EVENT_NAME,{url:droppedUrl});parent.dispatchEvent(customEvent)}return{removePreAndPost:removePreAndPost,addWrappingPs:addWrappingPs,dropOccurred:dropOccurred}}},{}],2:[function(require,module,exports){"use strict";module.exports=function(config){var helpers=require("./helpers")(config);var NODE_NAME="P";var filter=Array.prototype.filter;return function(scribe){var CURRENT_DROP_ID=undefined;var isEmpty=function(el){return el.childNodes.length===0};var bindableElements=function(){return filter.call(scribe.el.children,function(child){return child.nodeName===NODE_NAME})};var cleanup=function(){bindableElements().forEach(function(el){delete el.dataset.pre;delete el.dataset.post;delete el.dataset.dropid})};var bindDropIds=function(){cleanup();helpers.removePreAndPost(bindableElements());bindableElements().forEach(function(el,index){el.dataset.dropid=index})};bindDropIds();scribe.el.addEventListener("dragenter",function(event){var el=event.target;var dropid=el.dataset.dropid||null;if(!dropid){return}if(!isEmpty(el)&&CURRENT_DROP_ID!==dropid){helpers.removePreAndPost(bindableElements());helpers.addWrappingPs(el,dropid);CURRENT_DROP_ID=dropid}});scribe.el.addEventListener("drop",function(event){helpers.dropOccurred(event,bindableElements(),CURRENT_DROP_ID);bindDropIds()});scribe.el.addEventListener("dragend",function(){helpers.removePreAndPost(bindableElements())})}}},{"./helpers":1}]},{},[2])(2)});
//# sourceMappingURL=./build/scribe-plugin-drag-and-drop.min.js.map

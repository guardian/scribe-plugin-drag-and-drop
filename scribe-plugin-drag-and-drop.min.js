(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.scribePluginContentCleaner=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";module.exports=function(config){var INDICATOR_CLASS="drag-and-drop";var STYLE_CLASS=config.STYLE_CLASS||"scribe-plugin-drag-and-drop-default-style";var EVENT_NAME="scribe:url-dropped";var INSERT_POSITIONS=["PRE","POST"];var filter=Array.prototype.filter;var forEach=Array.prototype.forEach;function removePreAndPost(bindableElements){var els=document.getElementsByClassName(config.INDICATOR_CLASS);forEach.call(els,function(el){el.parentElement.removeChild(el)});var classed=document.getElementsByClassName(config.STYLE_CLASS);forEach["class"](classed,function(el){el.parentElement.removeChild(el)});bindableElements.forEach(function(el){el.dataset.pre=false;el.dataset.post=false})}function insertP(el,position,dropId){var parent=el.parentElement;var p=document.createElement("p");p.classList.add(INDICATOR_CLASS);p.classList.add(STYLE_CLASS);if(position==="PRE"&&el.dataset&&el.dataset.pre!=="true"){parent.insertBefore(p,el);el.dataset.pre=true;return el.dataset.pre}if(position==="POST"&&el.dataset&&el.dataset.post!=="true"){parent.insertBefore(p,el.nextSibling);el.dataset.post=true;return el.dataset.post}return false}function addWrappingPs(el,dropid){INSERT_POSITIONS.forEach(function(pos){return insertP(el,pos,dropid)})}function dropOccurred(event,bindableElements,dropid,scribe){var el=event.target;var parent=el.parentElement;el.removeAttribute("class");el.classList.remove(STYLE_CLASS);scribe.transactionManager.run(function(){return removePreAndPost(bindableElements)});var droppedUrl=event.dataTransfer.getData("URL");event.target.textContent=droppedUrl;var customEvent=new CustomEvent(EVENT_NAME,{detail:{dataTransfer:event.dataTransfer,element:event.target}});parent.dispatchEvent(customEvent)}function delegate(element,eventType,selector,callback){element.addEventListener(eventType,function(event){if(event.target.matches(selector)){callback.call(event.target,event)}})}return{removePreAndPost:removePreAndPost,addWrappingPs:addWrappingPs,dropOccurred:dropOccurred,delegate:delegate}}},{}],2:[function(require,module,exports){"use strict";module.exports=function(config){var helpers=require("./helpers")(config);var NODE_NAME="P";var filter=Array.prototype.filter;return function(scribe){var CURRENT_DROP_ID=undefined;var isEmpty=function(el){return el.childNodes.length===0};var bindableElements=function(){return filter.call(scribe.el.children,function(child){return child.nodeName===NODE_NAME})};var cleanup=function(){CURRENT_DROP_ID=null;helpers.removePreAndPost(bindableElements());bindableElements().forEach(function(el){el.removeAttribute("data-pre");el.removeAttribute("data-post");el.removeAttribute("data-dropid")})};var bindDropIds=function(){cleanup();bindableElements().forEach(function(el,index){el.dataset.dropid=index})};scribe.on("content-changed",function(){if(!CURRENT_DROP_ID){bindDropIds()}});scribe.transactionManager.run(function(){bindDropIds()});helpers.delegate(scribe.el,"dragenter","p",function(event){event.preventDefault();var el=event.target;var dropid=el.dataset.dropid||null;if(!dropid){return}if(isEmpty(el)){el.classList.add(config.STYLE_CLASS);return}if(!isEmpty(el)&&CURRENT_DROP_ID!==dropid){helpers.removePreAndPost(bindableElements());helpers.addWrappingPs(el,dropid);CURRENT_DROP_ID=dropid}});helpers.delegate(scribe.el,"drop","p",function(event){event.preventDefault();helpers.dropOccurred(event,bindableElements(),CURRENT_DROP_ID,scribe);bindDropIds()});helpers.delegate(scribe.el,"dragend","p",function(){helpers.removePreAndPost(bindableElements())})}}},{"./helpers":1}]},{},[2])(2)});
//# sourceMappingURL=./build/scribe-plugin-drag-and-drop.min.js.map
